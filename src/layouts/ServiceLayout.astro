---
import BaseLayout from './BaseLayout.astro';

interface SnapshotItem {
  icon: string;
  bold: string;
  text: string;
}

interface Breadcrumb {
  name: string;
  url: string;
}

interface FAQ {
  question: string;
  answer: string;
}

interface Props {
  title: string;
  description: string;
  canonical?: string;
  keywords?: string;
  heroTitle: string;
  heroSubtitle?: string;
  heroIntro: string;
  snapshot: SnapshotItem[];
  breadcrumbs: Breadcrumb[];
  faqs?: FAQ[];
  serviceType?: string;
}

const { 
  title, 
  description, 
  canonical,
  keywords = '',
  heroTitle,
  heroSubtitle = '',
  heroIntro,
  snapshot,
  breadcrumbs,
  faqs = [],
  serviceType = 'Document Translation'
} = Astro.props;

const siteUrl = 'https://onlinetranslation.ae';

const serviceSchema = {
  "@context": "https://schema.org",
  "@type": "Service",
  "name": heroTitle,
  "description": description,
  "provider": {
    "@type": "LocalBusiness",
    "name": "OnlineTranslation.ae",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Palm Jumeirah",
      "addressLocality": "Dubai",
      "addressCountry": "AE"
    },
    "telephone": "+971508620217",
    "email": "info@onlinetranslation.ae"
  },
  "areaServed": ["Dubai", "Abu Dhabi", "Sharjah", "UAE"],
  "serviceType": [serviceType, "Legal Translation"]
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": breadcrumbs.map((crumb, i) => ({
    "@type": "ListItem",
    "position": i + 1,
    "name": crumb.name,
    "item": crumb.url.startsWith('http') ? crumb.url : `${siteUrl}${crumb.url}`
  }))
};

const faqSchema = faqs.length > 0 ? {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqs.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
} : null;
---

<BaseLayout title={title} description={description} canonical={canonical}>
  <Fragment slot="head">
    {keywords && <meta name="keywords" content={keywords} />}
    <script type="application/ld+json" set:html={JSON.stringify(serviceSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
    {faqSchema && <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />}
  </Fragment>

  <!-- Breadcrumbs -->
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    <div class="container">
      {breadcrumbs.map((crumb, i) => (
        <Fragment>
          {i > 0 && <span class="breadcrumb-sep"><i class="fas fa-chevron-right"></i></span>}
          {i === breadcrumbs.length - 1 ? (
            <span class="breadcrumb-current">{crumb.name}</span>
          ) : (
            <a href={crumb.url} class="breadcrumb-link">{crumb.name}</a>
          )}
        </Fragment>
      ))}
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="section section--hero bg-dark">
    <div class="container">
      <div class="row">
        <div class="col col--8">
          <h1 class="hero-title">{heroTitle}</h1>
          {heroSubtitle && <h2 class="hero-subtitle-accent">{heroSubtitle}</h2>}
          <p class="hero-intro">{heroIntro}</p>
          
          <div class="service-snapshot">
            {snapshot.map(item => (
              <div class="snapshot-item">
                <i class={`fas fa-${item.icon}`}></i>
                <span><strong>{item.bold}</strong> {item.text}</span>
              </div>
            ))}
          </div>

          <div class="hero-cta-group">
            <a href="https://wa.me/971508620217" class="btn btn--primary btn--lg">
              <i class="fab fa-whatsapp"></i>
              Send Your Document
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <slot />

  <!-- FAQ Section -->
  {faqs.length > 0 && (
    <section class="section bg-light">
      <div class="container">
        <h2>Frequently Asked Questions</h2>
        <div class="faq-list">
          {faqs.map(faq => (
            <details class="faq-item">
              <summary class="faq-question">{faq.question}</summary>
              <div class="faq-answer">
                <p>{faq.answer}</p>
              </div>
            </details>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- CTA Section -->
  <section class="section bg-dark">
    <div class="container text-center">
      <h2>Ready to Get Started?</h2>
      <p style="max-width: 600px; margin: 0 auto 2rem;">Send your document via WhatsApp for a free assessment. We will confirm requirements and provide a quote within 15 minutes during working hours.</p>
      <a href="https://wa.me/971508620217" class="btn btn--primary btn--lg">
        <i class="fab fa-whatsapp"></i>
        Start on WhatsApp
      </a>
    </div>
  </section>

</BaseLayout>

<style>
  .breadcrumbs {
    background: var(--primary-color, #0E2B48);
    padding: 0.75rem 0;
  }
  
  .breadcrumbs .container {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  
  .breadcrumb-link {
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .breadcrumb-link:hover {
    color: #ffffff;
  }
  
  .breadcrumb-sep {
    color: rgba(255, 255, 255, 0.4);
    font-size: 0.7rem;
  }
  
  .breadcrumb-current {
    color: rgba(255, 255, 255, 0.95);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .hero-title {
    font-family: var(--font-primary);
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 800;
    line-height: 1.1;
    letter-spacing: 0.08em;
    margin: 0 0 0.5rem;
    text-transform: uppercase;
  }
  
  .hero-subtitle-accent {
    font-family: var(--font-primary);
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    font-weight: 800;
    color: var(--accent-color, #FF1654);
    margin: 0 0 1.5rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }
  
  .hero-intro {
    font-size: 1.1rem;
    line-height: 1.7;
    margin-bottom: 1.5rem;
    max-width: 700px;
  }
  
  .hero-cta-group {
    margin-top: 2rem;
  }
  
  .text-center {
    text-align: center;
  }
  
  .faq-list {
    max-width: 800px;
  }
  
  .faq-item {
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 1rem 0;
  }
  
  .faq-question {
    font-weight: 600;
    font-size: 1.05rem;
    cursor: pointer;
    list-style: none;
    padding-right: 2rem;
    position: relative;
  }
  
  .faq-question::after {
    content: '+';
    position: absolute;
    right: 0;
    top: 0;
    font-size: 1.5rem;
    color: var(--accent-color);
  }
  
  .faq-item[open] .faq-question::after {
    content: 'âˆ’';
  }
  
  .faq-answer {
    padding-top: 1rem;
  }
  
  .faq-answer p {
    margin: 0;
    line-height: 1.7;
    color: var(--text-muted);
  }
  
  @media (max-width: 768px) {
    .hero-title {
      font-size: 1.75rem;
    }
    
    .hero-subtitle-accent {
      font-size: 1.25rem;
    }
  }
</style>
